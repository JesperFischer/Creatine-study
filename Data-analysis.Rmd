---
title: "Pre-registered randomized double blinded creatine study on recreational climbers"
author: "Jesper Fischer Ehmsen"
date: "`r Sys.Date()`"
output:
  
  html_document: default
  word_document: default
  pdf_document:
    keep_tex: yes
  header-includes:
    \usepackage{table}
    \usepackage{tabular}   
link-citations: yes
linkcolor: blue
csl: nature.csl
---

```{r setup, include=FALSE, eval=TRUE}
#library(kableExtra)
library(ppcor)
library(tidyverse)
library(janitor)
library(ggplot2)
library(gridExtra)
library(dplyr)
library(kableExtra)
library(tidyr)
library(gghalves)
library(patchwork)
library(cowplot)

#knitr::opts_chunk$set(echo = TRUE)

```


Abstract
===============================================================================



Introduction
==============================================================================
Climbing as a sport has been growing in popularity as a sport in recent years, with its presence seem in the olypmic games 2020. Climbing as a competetive sport invovles many aspect of athletic performance, but descriptive hallmarks of a great climber seems to evovle around great upper body including finger strength compared to the bodyweight of the althlete as well as a relativly low bodyweight (REf,ref,ref).




Methods
===============================================================================


```{r, include=FALSE, eval = T}
source("scripts.R")
data = get_data()

```

This project was pre-registered in [osf](https://osf.io/3vf6x) and the methods and statistical analyses are therefore in accordance to the pre-registration unless stated as an exploratory analysis.

#### **Participants**
After given written consent `r length(unique(data$id))` recreational climbers (f = `r data %>% filter(k_n2 == 2) %>% summarize(n = n()/2)`) with `r round(mean(data$klatre_r2,na.rm = T),1)` $\pm$ `r round(sd(data$klatre_r2,na.rm = T),1)` (mean $\pm$ sd) years of climbing experience completed a battery of climbing specific exercises and agreed to turn up the following week the same time of day. Participants were given either pure maltodextrin or a combination of creatine and maltodextrin and were instructed to ingest 7.5grams 4 times a day, as evenly distributed as possible. The creatine arm of the experiment also ingested maltodextrin due to strengthening of the blinding as maltodextrin tastes sweet and creatine monohydrate is flavourless. Exclusion citeria of the current study included (a) not ingesting the powder (b) useage of creatine in the last 6 months (c) training in the last 48 hours up to testing (d) ingestion of alcohol, caffeine or other performance modulating substances in the last 6 hours. Participants in the study (between `r range(data$alder2, na.rm = T)[1]` and `r range(data$alder2, na.rm = T)[2]`) were pseudo-randomly divided into two groups such that each group had similar characteristics (age,physical performance, years of climbing experience, blabllblablalballba), this pseudo randomization was conducted by a third party such that the study was double blinded. The study was conducted in accordance with the Declaration of Helsinki and was approved by the ethics committee of the responsible department.

```{r, include = F, eval=T}
table_general = get_summary_general(data)
table = get_summary(data)
```

```{r, warning = F, message = F, echo = F}
rownames(table_general) = c("Age","Climbing experience (years)","Self report pull ups","self reported sports grade","self reported bouldering grade","Height (cm)","Ape index (cm)")

#boulding
table_general[5,1] = "[6a+ ; 7C]"
table_general[5,2] = "[6a+ ; 7C]"
#sports
table_general[4,1] = "[6b ; 8a]"
table_general[4,2] = "[6b ; 7C]"


kbl(table_general, caption = "Table 1 descriptive summary of the Placebo (n = 16) and the Creatine (n = 16) group") %>%
  kable_classic()
```

#### **Testing procedure**

Climbers firstly did a 5 minute standardized warm-up, hereafter they went through a battery of 8 strength measuring tests and finally 5 minute testing on a standardized climbing circuit board (moon-board). The battery of strength tests was performed in the following order for all participants. First maximal isometric voluntary contraction (MIVC) of the finger flexors in a crimped position was assessed. After 30 seconds rest maximal number of pull ups were performed, which were defined as chin over the bar and minimal momentum. After a minutes rest the climbers were to hang as long as possible on a 20mm edge in a half crimp position. Next MIVC was measured in a pinch position for both left and right hand. After another minute of rest participants performed the last strength exercise, a 90$^{\circ}$ biceps lock off with a dumbbell. The weight of the dumbbell was determined by the number of pull ups performed on the first testing day (i.e prior to creatine or placebo ingestion), > 10 pull ups was accompanied by a dumbbell weight of 17kg (if this was still to much to be held for less than 5 seconds, 13 kg was used) > 15 pull ups with 21kg and < 15 pull ups with 25kg. After another minutes of rest participants were instructed in climbing on the moon board where five pre-selected climbing rutes were chosen of gradual increase in difficulty, the climbers then had 5 minutes to complete as many of the five climbing rutes or get as far as possible on the first rute.
The testing protocol was performed twice, one in the inital visit and one after a week of creatine or placebo. Due to reported time of day fluctuations of strength, the climbers all completed the second visit within 2 hours of the time the week prior (REF).
To ensure no errors occurred doing counting or timing of participants as well as ensure the same quality of reps on the pre and post sessions as participants were filmed and the videos were afterwards double checked to match with the recorded reps and time. Temperature and humidity was also monitored, when the participants started their session. 


### **Statistical analysis**
All statistical analysis was performed in the statistical programming language R (REF). The analysis of choice to maximize statistical power and minimize the number of statistical tests was a repeated measures MANOVA with all 8 strength tests included as dependent variables. Assumption of univariate normality was assessed using shapiro-Wilks test, assumption of multivariate normality was tested with Mardias test and lastly the assumption of homogeneity of variances and covariances was tested using box's M test (see appendix). 



The sample size of the current study was calculated using the latest meta analysis on the effects of creatine on upper body strength (REF), which indicated that a sample size of 32 was needed to achieve 80% power and $\alpha$ = 0.05.


Results
===============================================================================


```{r, warning = F, message = F, echo = F}
#a = data %>% select(crimphøjremax,crimpvenstremax, pinchhøjremax, pinchvenstremax,pullups_r,lattice_r,ll_r,lr_r)
#corrplot(cor(a,use = "complete.obs"), method = "pie")
```



```{r, include=FALSE, eval = T}
#source("scripts.R")
#data = get_data1()


#uden kropsvægt:
m1 = manova(cbind(crimphøjremax,crimpvenstremax, pinchhøjremax, pinchvenstremax,pullups_r,lattice_r,ll_r,lr_r) ~ 
              gruppe*tid+Error(id),
              data = data)



results = summary(m1)
```


```{r, include=FALSE, eval = T}
#h3
library(lme4)
moon = summary(lmerTest::lmer(moon.tal ~ gruppe*tid+(1|id), data = data))
coef_moon = moon$coefficients

```


Following the pre registered analysis a significant pre to post time effect was observed for the dependent variables F = `r format(results$"Error: Within"$stats[1,3], scientific = F, digits = 2)` p = `r format(results$"Error: Within"$stats[1,6], scientific = F, digits = 2)` without a significant interaction effect between group and time F = `r format(results$"Error: Within"$stats[2,3], scientific = F, digits = 2)` p = `r format(results$"Error: Within"$stats[2,6], scientific = F, digits = 2)`.
Using a linear mixed effects models the interaction was tested separately for the number of moves performed on the moon board which revealed a significant time effect 
$\beta$ = `r format(coef_moon[3,1], scientific = F, digits = 2)`, se = `r format(coef_moon[3,2], scientific = F, digits = 2)`, t(`r format(coef_moon[3,3], scientific = F, digits = 2)`) = `r format(coef_moon[3,4], scientific = F, digits = 2)` p = `r format(coef_moon[3,5], scientific = F, digits = 2)`
without a significant interaction effect $\beta$ = `r format(coef_moon[4,1], scientific = F, digits = 2)`, se = `r format(coef_moon[4,2], scientific = F, digits = 2)`, t(`r format(coef_moon[4,3], scientific = F, digits = 2)`) = `r format(coef_moon[4,4], scientific = F, digits = 2)` p = `r format(coef_moon[4,5], scientific = F, digits = 2)`


\newpage

```{r, warning = F, message = F, echo = F}
# kbl(table,caption = "Table 2 \n Intervention effect, one week of either creatine (n = 16) or placebo (n = 16)") %>%
#   kable_classic() %>% 
#   add_header_above(c(" " = 1, "Placebo" = 2, "Creatine" = 2))
```


Exploratory analysis:
=============================
```{r, include=FALSE, eval = T}
# Explorative analysis
summary(lmerTest::lmer(crimphøjremax ~ gruppe*tid+(1|id), data = data))
summary(lmerTest::lmer(crimpvenstremax ~ gruppe*tid+(1|id), data = data))
summary(lmerTest::lmer(pinchhøjremax ~ gruppe*tid+(1|id), data = data))
summary(lmerTest::lmer(pinchvenstremax ~ gruppe*tid+(1|id), data = data))
summary(lmerTest::lmer(pullups_r ~ gruppe*tid+(1|id), data = data))
summary(lmerTest::lmer(lattice_r ~ gruppe*tid+(1|id), data = data))

lockoff_left = summary(lmerTest::lmer(ll_r ~ gruppe*tid+(1|id), data = data))
lockoff_right = summary(lmerTest::lmer(lr_r ~ gruppe*tid+(1|id), data = data))
coef_lockoff_left = lockoff_left$coefficients
coef_lockoff_right = lockoff_right$coefficients

```

Due to the trending significant interaction effect on the 8 dependent strength variables of interest, we conducted individual groups by time interaction analyses to investigate which of the strength tests drove the effect. Significant interaction effects were found for the last two exercises i.e. time to failure on isometric 90 degree elbow flexion holds for both right $\beta$ = `r round(coef_lockoff_right[4,1],2)`, se = `r format(coef_lockoff_right[4,2], scientific = F, digits = 2)`, t(`r format(coef_lockoff_right[4,3], scientific = F, digits = 2)`) = `r format(coef_lockoff_right[4,4], scientific = F, digits = 2)` p = `r format(coef_lockoff_right[4,5], scientific = F, digits = 2)` and left $\beta$ = `r format(coef_lockoff_left[4,1], scientific = F, digits = 2)`, se = `r format(coef_lockoff_left[4,2], scientific = F, digits = 2)`, t(`r format(coef_lockoff_left[4,3], scientific = F, digits = 2)`) = `r format(coef_lockoff_left[4,4], scientific = F, digits = 2)` p = `r format(coef_lockoff_left[4,5], scientific = F, digits = 2)`.



```{r}
rownames(table) = c("R crimp (N)","L crimp (N)","Static hold on 20mm edge (S)","L Isometric elbow flexion hold (S)","R Isometric elbow flexion hold (S)","Moon board (moves)","Body weight (Kg)","Pull ups","R Pinch (N)","L Pinch (N)")


kbl(table, caption = "Table 2 descriptive summary of the Placebo (n = 16) and the Creatine (n = 16) group between visit 1 (pre) and visit 2 (post)") %>%
  kable_classic()%>%
  add_header_above(c(" " = 1, "Placebo" = 2, "Creatine" = 2), align = "center")
```




Discussion
===============================================================================







Appendix
================================
```{r, include = F, eval=T}
#check for univariate normality.
library(rstatix)
data %>% group_by(tid,gruppe) %>%  shapiro_test(crimphøjremax,crimpvenstremax, pinchhøjremax, pinchvenstremax,pullups_r,lattice_r,ll_r,lr_r)

#multivariate normality using Mardia’s Skewness and Kurtosis test,
library(mvnormalTest)
mardia(data[, c("crimphøjremax", "crimpvenstremax","pinchhøjremax","pinchvenstremax","pullups_r","lattice_r","ll_r","lr_r")])$mv.test

##box m test
library(heplots)
boxM(Y = data[, c("crimphøjremax", "crimpvenstremax","pinchhøjremax","pinchvenstremax","pullups_r","lattice_r","ll_r","lr_r")], group = data$tid)
boxM(Y = data[, c("crimphøjremax", "crimpvenstremax","pinchhøjremax","pinchvenstremax","pullups_r","lattice_r","ll_r","lr_r")], group = data$gruppe)


library(rstatix)
# get distance (outlier test:)
mahalanobis_distance(data = data[, c("crimphøjremax", "crimpvenstremax","pinchhøjremax","pinchvenstremax","pullups_r","lattice_r","ll_r","lr_r")])$is.outlier

#correlation-test to see if some are very correlated
cor.test(x = data$pinchhøjremax, y = data$pinchvenstremax, method = "pearson")$estimate
cor.test(x = data$ll_r, y = data$lr_r, method = "pearson")$estimate
cor.test(x = data$lattice_r, y = data$pullups_r, method = "pearson")$estimate

cor.test(x = data$lattice_r, y = data$pullups_r, method = "pearson")$estimate

```



